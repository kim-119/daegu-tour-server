<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>대구 투어 가이드 - 아름다운 대구 여행의 시작</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --primary: #e74c3c; /* 주요 색상 (빨간 계열) */
            --primary-dark: #c0392b;
            --secondary: #3498db; /* 보조 색상 (파란 계열) */
            --secondary-dark: #2980b9;
            --accent: #f39c12; /* 강조 색상 (주황 계열) */
            --dark: #2c3e50; /* 어두운 텍스트/배경 */
            --light: #ecf0f1; /* 밝은 배경 */
            --gray: #7f8c8d; /* 회색 텍스트 */
            --white: #ffffff;
            --blue: #2563eb; /* 로고 등에 사용되는 파란색 */
            --bookmark-active: #f1c40f; /* 활성화된 북마크 별 색상 (노란색) */
        }
        
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        html, body { 
            width: 100%; 
            background-color: var(--light); 
            font-family: 'Noto Sans KR', sans-serif; 
            color: var(--dark);
            line-height: 1.6;
        }
        
        /* 헤더 스타일 */
        header {
            background-color: var(--white);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .logo { display: flex; align-items: center; gap: 10px; }
        .logo img { height: 40px; width: auto; }
        .logo h1 { font-size: 1.5rem; font-weight: 700; color: var(--blue); }
        
        .language-selector { display: flex; align-items: center; gap: 10px; margin-left: auto; margin-right: 20px; }
        .language-selector select { padding: 8px 12px; border: 1px solid #ddd; border-radius: 5px; background-color: var(--white); color: var(--dark); font-size: 0.9rem; }
        
        nav ul { display: flex; list-style: none; gap: 20px; /* 간격 약간 줄임 */ }
        nav a { text-decoration: none; color: var(--dark); font-weight: 500; font-size: 0.95rem; /* 약간 작게 */ transition: color 0.3s; position: relative; }
        nav a:hover { color: var(--primary); }
        nav a::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -5px; left: 0; background-color: var(--primary); transition: width 0.3s; }
        nav a:hover::after { width: 100%; }
        
        .mobile-menu-btn { display: none; background: none; border: none; font-size: 1.5rem; color: var(--dark); cursor: pointer; }

        /* 섹션 공통 스타일 */
        .section { padding: 60px 5%; max-width: 1400px; margin: 0 auto; } /* 패딩 약간 줄임 */
        .section-title { text-align: center; margin-bottom: 40px; } /* 마진 약간 줄임 */
        .section-title h2 { font-size: 2.2rem; color: var(--dark); margin-bottom: 10px; position: relative; display: inline-block; } /* 크기, 마진 약간 줄임 */
        .section-title h2::after { content: ''; position: absolute; width: 40px; height: 3px; background-color: var(--primary); bottom: -8px; left: 50%; transform: translateX(-50%); }
        .section-title p { font-size: 1rem; color: var(--gray); max-width: 600px; margin: 0 auto; } /* 크기, 너비 약간 줄임 */
        
        /* 검색 섹션 */
        .search-section { background-color: var(--white); padding: 25px 5%; margin-top: 70px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .search-container { max-width: 800px; margin: 0 auto; display: flex; gap: 10px; flex-wrap: wrap; align-items: center; justify-content: center; }
        .search-input { flex: 1; min-width: 180px; padding: 10px 15px; border: 1px solid #ddd; border-radius: 20px; font-size: 0.95rem; outline: none; }
        .search-input:focus { border-color: var(--primary); box-shadow: 0 0 0 2px rgba(231, 76, 60, 0.1); }
        .filter-select { padding: 10px 15px; border: 1px solid #ddd; border-radius: 20px; background-color: var(--white); font-size: 0.95rem; outline: none; }
        .search-btn { padding: 10px 20px; background-color: var(--primary); color: var(--white); border: none; border-radius: 20px; font-size: 0.95rem; cursor: pointer; transition: all 0.3s; }
        .search-btn:hover { background-color: var(--primary-dark); transform: translateY(-1px); }
        
        /* 메인 배너 */
        .hero-banner { height: 65vh; background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('대구 지도.png'); background-size: cover; background-position: center; display: flex; align-items: center; justify-content: center; text-align: center; color: var(--white); padding: 0 20px; }
        .hero-content { max-width: 700px; }
        .hero-content h2 { font-size: 2.5rem; margin-bottom: 15px; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); }
        .hero-content p { font-size: 1.1rem; margin-bottom: 25px; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); }
        .btn { display: inline-block; padding: 10px 25px; background-color: var(--primary); color: var(--white); text-decoration: none; border-radius: 5px; font-weight: 500; transition: all 0.3s; border: none; cursor: pointer; margin: 5px; font-size: 0.95rem; }
        .btn:hover { background-color: var(--primary-dark); transform: translateY(-2px); }
        .btn-outline { background-color: transparent; border: 2px solid var(--white); }
        .btn-outline:hover { background-color: var(--white); color: var(--primary); }

        /* 지역별 관광 섹션 */
        .regions-section { background-color: var(--white); }
        .regions-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; } /* 카드 크기, 간격 조정 */
        .region-card { background-color: var(--white); border-radius: 8px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.08); transition: all 0.3s; cursor: pointer; }
        .region-card:hover { transform: translateY(-8px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .region-img { 
            height: 200px; /* 사진 잘림 문제 개선 */
            overflow: hidden;
            position: relative; 
        }
        .region-img img { 
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center; /* 사진 잘림 문제 개선 */
            transition: transform 0.4s;
        }
        .region-card:hover .region-img img { transform: scale(1.08); }
        .region-content { padding: 18px; text-align: center; }
        .region-content h3 { font-size: 1.3rem; margin-bottom: 8px; color: var(--dark); }
        .region-content p { color: var(--gray); margin-bottom: 12px; font-size: 0.9rem; }
        .region-icon { font-size: 2.2rem; color: var(--primary); margin-bottom: 12px; }
        
        /* 검색 결과, 인기 관광지, 즐겨찾기 목록 공통 그리드 */
        .results-grid, .popular-grid, .bookmarks-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }
        
        /* 관광지 카드 스타일 */
        .place-card { background-color: var(--white); border-radius: 8px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.08); transition: all 0.3s; display: flex; flex-direction: column; }
        .place-card:hover { transform: translateY(-8px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .place-img { 
            height: 200px; /* 사진 잘림 문제 개선 */
            overflow: hidden; 
            position: relative; 
            cursor: pointer; 
        }
        .place-img img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            object-position: center; /* 사진 잘림 문제 개선 */
            transition: transform 0.4s; 
        }
        .place-card:hover .place-img img { transform: scale(1.08); }
        
        .visit-count { position: absolute; top: 8px; right: 8px; background-color: rgba(0,0,0,0.6); color: var(--white); padding: 4px 8px; border-radius: 12px; font-size: 0.75rem; }
        .bookmark-icon { position: absolute; top: 8px; left: 8px; font-size: 1.5rem; color: var(--gray); cursor: pointer; transition: color 0.2s, transform 0.2s; text-shadow: 0 0 3px rgba(0,0,0,0.3); }
        .bookmark-icon.active { color: var(--bookmark-active); transform: scale(1.1); }
        .bookmark-icon:hover { transform: scale(1.2); }

        .place-content { padding: 18px; flex-grow: 1; display: flex; flex-direction: column; }
        .place-content h3 { font-size: 1.2rem; margin-bottom: 8px; color: var(--dark); }
        .place-content p { color: var(--gray); margin-bottom: 12px; font-size: 0.9rem; line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; flex-grow: 1; }
        .place-footer { display: flex; justify-content: flex-end; /* 지도 버튼만 오른쪽으로 */ align-items: center; padding-top: 12px; border-top: 1px solid #eee; margin-top: auto; }
        .map-btn { color: var(--secondary); text-decoration: none; font-weight: 500; display: flex; align-items: center; gap: 4px; font-size: 0.9rem; }
        .map-btn:hover { color: var(--secondary-dark); }

        /* 인기 관광지 섹션 */
        .popular-section { background-color: #f8f9fa; }
        
        /* 즐겨찾기 섹션 */
        .my-bookmarks-section { background-color: var(--light); } 

        /* AI 추천 섹션 */
        .ai-recommend-section { background-color: var(--white); }
        .ai-recommend-container { max-width: 900px; margin: 0 auto; text-align: center; }
        .ai-form { display: flex; gap: 12px; margin-bottom: 25px; justify-content: center; flex-wrap: wrap; }
        .form-group { flex: 1; min-width: 180px; max-width: 220px; }
        .form-group label { display: block; margin-bottom: 6px; font-weight: 500; color: var(--dark); text-align: left; font-size: 0.9rem; }
        .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 0.95rem; color: var(--dark); background-color: var(--white); }
        .ai-result { background-color: #f8f9fa; border-radius: 8px; padding: 18px; margin-top: 18px; text-align: left; }
        .ai-result h3 { color: var(--primary); margin-bottom: 12px; font-size: 1.2rem; text-align: center; }
        .course-item { background-color: var(--white); padding: 12px; border-radius: 5px; margin-bottom: 8px; border-left: 3px solid var(--primary); display: flex; align-items: center; gap: 12px; cursor: pointer; }
        .course-item img { width: 50px; height: 50px; object-fit: cover; border-radius: 4px; }
        .course-info { flex: 1; }
        .course-info h4 { margin-bottom: 4px; color: var(--dark); font-size: 1rem; }
        .course-info p { font-size: 0.85rem; color: var(--gray); -webkit-line-clamp: 2; display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; }
        .map-link { display: inline-block; margin-top: 12px; color: var(--secondary); text-decoration: none; font-weight: 500; text-align: center; width: 100%; font-size: 0.95rem; }
        .map-link:hover { text-decoration: underline; }
        
        /* 통계 섹션 */
        .stats-section { background-color: var(--dark); color: var(--white); }
        .stats-container { max-width: 1100px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 25px; }
        .stat-card { text-align: center; padding: 25px; background-color: rgba(255,255,255,0.08); border-radius: 8px; }
        .stat-card i { font-size: 2.5rem; color: var(--primary); margin-bottom: 12px; }
        .stat-card h3 { font-size: 1.8rem; margin-bottom: 8px; }
        .stat-card p { color: var(--light); font-size: 0.9rem; }
        
        /* 푸터 섹션 */
        footer { background-color: var(--dark); color: var(--light); padding: 50px 5% 25px; }
        .footer-container { max-width: 1400px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; }
        .footer-col h3 { font-size: 1.2rem; margin-bottom: 18px; color: var(--white); position: relative; padding-bottom: 8px; }
        .footer-col h3::after { content: ''; position: absolute; width: 35px; height: 2px; background-color: var(--primary); bottom: 0; left: 0; }
        .footer-col p { color: var(--gray); margin-bottom: 12px; font-size: 0.9rem; }
        .footer-links { list-style: none; padding-left: 0; }
        .footer-links li { margin-bottom: 8px; }
        .footer-links a { color: var(--gray); text-decoration: none; transition: color 0.3s; font-size: 0.9rem; }
        .footer-links a:hover { color: var(--primary); }
        .contact-info { display: flex; align-items: center; gap: 8px; margin-bottom: 12px; }
        .contact-info i { color: var(--primary); font-size: 1rem; width: 18px; text-align: center; }
        .social-links { display: flex; gap: 12px; margin-top: 18px; }
        .social-links a { display: flex; align-items: center; justify-content: center; width: 36px; height: 36px; background-color: rgba(255,255,255,0.1); border-radius: 50%; color: var(--white); transition: all 0.3s; font-size: 0.9rem; }
        .social-links a:hover { background-color: var(--primary); transform: translateY(-2px); }
        .copyright { text-align: center; padding-top: 25px; margin-top: 25px; border-top: 1px solid rgba(255,255,255,0.1); color: var(--gray); font-size: 0.85rem; }

        /* 로딩 화면 */
        .loading-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(255,255,255,0.9); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 2000; }
        .loading-spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 15px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* 반응형 디자인 */
        @media (max-width: 992px) { 
            nav ul { gap: 15px; }
            nav a { font-size: 0.9rem; }
            .section-title h2 { font-size: 2rem; }
            .hero-content h2 { font-size: 2.2rem; }
        }

        @media (max-width: 768px) { 
            .header-container { padding: 12px 15px; height: 60px; } 
            .logo h1 { font-size: 1.3rem; }
            .language-selector { margin-right: 8px; }
            .language-selector select { padding: 6px 10px; font-size: 0.85rem; }
            nav { display: none; position: absolute; top: 60px; left: 0; width: 100%; background-color: var(--white); box-shadow: 0 5px 10px rgba(0,0,0,0.1); padding: 15px; }
            nav.active { display: block; }
            nav ul { flex-direction: column; gap: 12px; }
            .mobile-menu-btn { display: block; }
            .section { padding: 40px 15px; }
            .section-title h2 { font-size: 1.8rem; }
            .section-title p { font-size: 0.95rem; }
            .search-section { padding: 20px 15px; margin-top: 60px; }
            .search-container { flex-direction: column; }
            .search-input, .filter-select, .search-btn { min-width: 100%; width: 100%; font-size: 0.9rem; padding: 10px 12px; }
            .hero-banner { height: 55vh; }
            .hero-content h2 { font-size: 1.8rem; }
            .hero-content p { font-size: 1rem; }
            .btn { padding: 8px 20px; font-size: 0.9rem; }
            .regions-grid, .results-grid, .popular-grid, .bookmarks-grid { grid-template-columns: 1fr; gap: 20px; } 
            .place-img, .region-img { height: 180px; } /* 모바일에서는 이미지 높이 다시 조정 */
            .place-content h3, .region-content h3 { font-size: 1.1rem; }
            .place-content p, .region-content p { font-size: 0.85rem; }
            .ai-form { flex-direction: column; }
            .course-item { flex-direction: column; text-align: center; }
            .stats-container { grid-template-columns: 1fr; } 
            .footer-container { grid-template-columns: 1fr; } 
        }
    </style>
</head>
<body>
    <!-- 헤더 -->
    <header>
        <div class="header-container">
            <div class="logo">
                <img src="/대구 마스코트.png" alt="대구 투어 로고" style="height: 40px;">

                <h1 id="siteTitle" data-text="title">대구 투어 가이드</h1>
            </div>
            <div class="language-selector">
                <select id="languageSelect" onchange="changeLanguage()">
                    <option value="ko">한국어</option>
                    <option value="en">English</option>
                    <option value="ja">日本語</option>
                    <option value="zh">中文</option>
                </select>
            </div>
            <nav id="mainNav">
                <ul>
                    <li><a href="#home" data-text="nav.home">홈</a></li>
                    <li><a href="#regions" data-text="nav.regions">지역별 관광</a></li>
                    <li><a href="#popular" data-text="nav.popular">인기 관광지</a></li>
                    <li><a href="#my-bookmarks" data-text="nav.bookmarks">내 즐겨찾기</a></li>
                    <li><a href="#recommend" data-text="nav.recommend">추천 코스</a></li>
                    <li><a href="#stats" data-text="nav.stats">여행 통계</a></li>
                </ul>
            </nav>
            <button class="mobile-menu-btn" id="mobileMenuBtn"><i class="fas fa-bars"></i></button>
        </div>
    </header>

    <!-- 메인 배너 -->
    <section id="home" class="hero-banner">
        <div class="hero-content">
            <h2 id="heroTitle" data-text="hero.title">대구의 아름다움을 발견하세요</h2>
            <p id="heroDescription" data-text="hero.description">역사적인 명소부터 자연의 경이로움, 활기찬 도시 생활까지 - 대구의 모든 것을 경험해보세요</p>
            <div class="hero-buttons">
                <a href="#search" class="btn" data-text="hero.buttons.regions">관광지 검색하기</a>
                <a href="#recommend" class="btn btn-outline" data-text="hero.buttons.recommend">추천 코스 보기</a>
            </div>
        </div>
    </section>

    <!-- 검색 섹션 -->
    <section id="search" class="search-section">
        <div class="search-container">
            <input type="text" id="searchInput" class="search-input" placeholder="관광지 검색..." data-placeholder="search.placeholder">
            <select id="regionFilter" class="filter-select">
                <option value="all" data-text="search.all">전체 지역</option>
                <option value="southwesternregion" data-text="regions.southwesternregion_short">동남/서남권</option>
                <option value="northeasternregion" data-text="regions.northeasternregion_short">동북권</option>
                <option value="JungguDistrict" data-text="regions.JungguDistrict_short">중구권</option>
            </select>
            <button id="searchBtn" class="search-btn" data-text="search.button"><i class="fas fa-search"></i> 검색</button>
        </div>
    </section>

    <!-- 지역별 관광 섹션 -->
    <section id="regions" class="section regions-section">
        <div class="section-title">
            <h2 data-text="regions.title">지역별 관광지</h2>
            <p data-text="regions.description">대구의 다양한 지역별 특색있는 관광지를 만나보세요</p>
        </div>
        <div class="regions-grid">
            <div class="region-card" onclick="searchPlacesByRegion('southwesternregion')">
                <div class="region-img"><img src="디아크.jfif" alt="동남/서남권"></div>
                <div class="region-content">
                    <div class="region-icon"><i class="fas fa-leaf"></i></div>
                    <h3 data-text="regions.southwesternregion">동남/서남권</h3>
                    <p data-text="regions.southwesternregion_desc">자연과 문화의 조화를 느낄 수 있는 지역</p>
                </div>
            </div>
            <div class="region-card" onclick="searchPlacesByRegion('northeasternregion')">
                <div class="region-img"><img src="동화사.jpg" alt="동북권"></div>
                <div class="region-content">
                    <div class="region-icon"><i class="fas fa-mountain"></i></div>
                    <h3 data-text="regions.northeasternregion">동북권</h3>
                    <p data-text="regions.northeasternregion_desc">역사와 전통의 숨결이 살아있는 지역</p>
                </div>
            </div>
            <div class="region-card" onclick="searchPlacesByRegion('JungguDistrict')">
                <div class="region-img"><img src="동성로.jfif" alt="중구권"></div>
                <div class="region-content">
                    <div class="region-icon"><i class="fas fa-city"></i></div>
                    <h3 data-text="regions.JungguDistrict">중구권</h3>
                    <p data-text="regions.JungguDistrict_desc">도심 속 문화와 쇼핑의 중심지</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 인기 관광지 섹션 -->
    <section id="popular" class="section popular-section">
        <div class="section-title">
            <h2 data-text="popular.title">인기 관광지</h2>
            <p data-text="popular.description">대구에서 가장 사랑받는 관광지를 소개합니다</p>
        </div>
        <div id="popularGrid" class="popular-grid"></div>
    </section>

    <!-- 내 즐겨찾기 섹션 -->
    <section id="my-bookmarks" class="section my-bookmarks-section">
        <div class="section-title">
            <h2 data-text="myBookmarks.title">내 즐겨찾기</h2>
            <p data-text="myBookmarks.description">즐겨찾기한 관광지 목록입니다.</p>
        </div>
        <div id="bookmarksGrid" class="bookmarks-grid"></div>
    </section>

    <!-- 검색 결과 표시 섹션 -->
    <section id="searchResultsDisplay" class="results-section section" style="display:none;">
        <div class="results-container">
            <div class="results-title">
                <h2 id="resultsTitle" data-text="searchResults.title">검색 결과</h2>
                <p id="resultsCount"></p>
            </div>
            <div id="resultsGrid" class="results-grid"></div>
        </div>
    </section>

    <!-- AI 추천 코스 섹션 -->
    <section id="recommend" class="ai-recommend-section section">
        <div class="ai-recommend-container">
            <div class="section-title">
                <h2 data-text="recommend.title">AI 맞춤 코스 추천</h2>
                <p data-text="recommend.description">당신의 취향에 맞는 최적의 여행 코스를 추천해드립니다</p>
            </div>
            <div class="ai-form">
                <div class="form-group">
                    <label for="themeSelect" data-text="recommend.theme">여행 테마</label>
                    <select id="themeSelect">
                        <option value="nature" data-text="recommend.themes.nature">🌿 자연 힐링</option>
                        <option value="history" data-text="recommend.themes.history">🏛️ 역사 문화</option>
                        <option value="culture" data-text="recommend.themes.culture">🎭 문화 체험</option>
                        <option value="shopping" data-text="recommend.themes.shopping">🛍️ 쇼핑 맛집</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="durationSelect" data-text="recommend.duration">여행 기간</label>
                    <select id="durationSelect">
                        <option value="half" data-text="recommend.durations.half">반나절 코스</option>
                        <option value="full" data-text="recommend.durations.full">하루 종일</option>
                    </select>
                </div>
                <div class="form-group" style="align-self: flex-end;">
                    <button class="btn" onclick="getRecommendation()" data-text="recommend.button"><i class="fas fa-magic"></i> 코스 추천받기</button>
                </div>
            </div>
            <div id="aiCourseBox" class="ai-result" style="display: none;"></div>
        </div>
    </section>

    <!-- 통계 섹션 -->
    <section id="stats" class="stats-section section">
        <div class="section-title">
             <h2 data-text="stats.title" style="color: var(--white);">여행 통계</h2>
             <p data-text="stats.description" style="color: var(--light);">대구 관광의 다양한 정보를 확인하세요</p>
        </div>
        <div class="stats-container">
            <div class="stat-card"><i class="fas fa-map-marked-alt"></i><h3 id="totalPlaces">0</h3><p data-text="stats.totalPlaces">총 관광지</p></div>
            <div class="stat-card"><i class="fas fa-eye"></i><h3 id="totalVisits">0</h3><p data-text="stats.totalVisits">총 조회수</p></div>
            <div class="stat-card"><i class="fas fa-star"></i><h3 id="mostPopularPlaceName">-</h3><p data-text="stats.mostPopular">가장 인기있는 곳</p></div>
            <div class="stat-card"><i class="fas fa-users"></i><h3 id="activeUsers">0</h3><p data-text="stats.activeUsers">오늘 방문자 (예시)</p></div>
        </div>
    </section>

    <!-- 푸터 섹션 -->
    <footer>
        <div class="footer-container">
            <div class="footer-col">
                <h3 data-text="footer.companyName">대구 투어 가이드</h3>
                <p data-text="footer.description">대구의 아름다운 관광지와 문화를 소개하는 공식 가이드입니다. 역사적인 명소부터 자연 경관, 쇼핑과 맛집까지 대구의 모든 것을 경험해보세요.</p>
                <div class="social-links">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" aria-label="Youtube"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            <div class="footer-col">
                <h3 data-text="footer.quickLinks">빠른 링크</h3>
                <ul class="footer-links">
                    <li><a href="#home" data-text="nav.home">홈</a></li>
                    <li><a href="#regions" data-text="nav.regions">지역별 관광</a></li>
                    <li><a href="#popular" data-text="nav.popular">인기 관광지</a></li>
                    <li><a href="#my-bookmarks" data-text="nav.bookmarks">내 즐겨찾기</a></li>
                    <li><a href="#recommend" data-text="nav.recommend">추천 코스</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3 data-text="footer.contactUs">연락처</h3>
                <div class="contact-info"><i class="fas fa-map-marker-alt"></i><p data-text="footer.address">대구광역시 중구 동성로 1길</p></div>
                <div class="contact-info"><i class="fas fa-phone"></i><p data-text="footer.phone">+82 53-123-4567</p></div>
                <div class="contact-info"><i class="fas fa-envelope"></i><p data-text="footer.email">info@daegutour.com</p></div>
            </div>
        </div>
        <div class="copyright">
            <p data-text="footer.copyright">&copy; 2025 대구 투어 가이드. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- 로딩 화면 -->
    <div id="loadingScreen" class="loading-screen"><div class="loading-spinner"></div><p data-text="loading">데이터를 불러오는 중...</p></div>

    <script>
        let currentLanguage = 'ko';
        let translations = {};
        let allPlacesData = null; // 초기 null로 설정, 로드 후 객체 할당
        let userBookmarks = [];
        let visits = {};
        const API_BASE = '';

        document.addEventListener('DOMContentLoaded', initializeApp);

        async function initializeApp() {
            console.log("[Client] initializeApp started.");
            showLoading();
            try {
                await loadTranslations(currentLanguage);
                console.log("[Client] Translations loaded.");

                // 모든 장소 데이터 로드를 먼저 완료시킴
                await loadAllPlacesFromServer();
                console.log("[Client] All places data loaded:", allPlacesData ? 'Data received' : 'No data/Error');
                if (!allPlacesData || Object.keys(allPlacesData).length === 0) {
                    console.error("[Client] Critical error: allPlacesData is not loaded or empty. Aborting further data loading.");
                    alert(getNestedProperty(translations, 'error.appInit') || '관광지 정보를 불러오지 못했습니다. 새로고침 해주세요.');
                    hideLoading();
                    return;
                }

                const bookmarksPromise = loadUserBookmarks();
                const visitsPromise = loadVisits();
                await Promise.all([bookmarksPromise, visitsPromise]);
                console.log("[Client] Bookmarks and visits loaded.");
                
                await loadPopularPlaces();
                console.log("[Client] Popular places displayed.");
                await loadBookmarkedPlacesDisplay();
                console.log("[Client] Bookmarked places displayed.");
                await loadStats();
                console.log("[Client] Stats updated.");
                
                setupEventListeners();
                console.log("[Client] Event listeners set up.");
            } catch (error) {
                console.error('[Client] initializeApp error:', error);
                alert(getNestedProperty(translations, 'error.appInit') || '앱 초기화 중 오류가 발생했습니다.');
            } finally {
                hideLoading();
                console.log("[Client] initializeApp finished.");
            }
        }

        function setupEventListeners() {
            document.getElementById('mobileMenuBtn').addEventListener('click', () => document.getElementById('mainNav').classList.toggle('active'));
            document.getElementById('searchInput').addEventListener('keypress', e => { if (e.key === 'Enter') searchPlaces(true); });
            document.querySelectorAll('a[href^="#"]').forEach(anchor => anchor.addEventListener('click', smoothScrollToAnchor));
            document.getElementById('searchBtn').addEventListener('click', () => searchPlaces(true));
        }
        
        function smoothScrollToAnchor(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                const header = document.querySelector('header');
                const headerOffset = header ? header.offsetHeight : 70;
                const elementPosition = targetElement.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                window.scrollTo({ top: offsetPosition, behavior: "smooth" });
                const nav = document.getElementById('mainNav');
                if (nav.classList.contains('active')) nav.classList.remove('active');
            }
        }

        function showLoading() { document.getElementById('loadingScreen').style.display = 'flex'; }
        function hideLoading() { document.getElementById('loadingScreen').style.display = 'none'; }

        async function loadTranslations(lang) {
            try {
                const response = await fetch(`${API_BASE}/api/translations/${lang}`);
                if (!response.ok) throw new Error(`HTTP ${response.status} for translations`);
                translations = await response.json();
                updateUIWithTranslations();
            } catch (error) {
                console.error(`[Client] loadTranslations error (${lang}):`, error);
                if (lang !== 'ko' && translations['ko']) {
                     updateUIWithTranslations(); 
                } else if (lang !== 'ko') { 
                    await loadTranslations('ko'); 
                }
            }
        }

        async function changeLanguage() {
            currentLanguage = document.getElementById('languageSelect').value;
            console.log(`[Client] Changing language to: ${currentLanguage}`);
            showLoading();
            await loadTranslations(currentLanguage);
            await loadPopularPlaces(); 
            await loadBookmarkedPlacesDisplay(); 
            const searchResultsSection = document.getElementById('searchResultsDisplay');
            if (searchResultsSection.style.display !== 'none') {
                await searchPlaces(false); 
            }
            await loadStats(); 
            hideLoading();
        }

        function updateUIWithTranslations() {
            document.documentElement.lang = currentLanguage;
            document.querySelectorAll('[data-text]').forEach(el => {
                const key = el.getAttribute('data-text');
                const text = getNestedProperty(translations, key);
                if (text !== null) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') el.placeholder = text;
                    else el.innerHTML = text;
                }
            });
            document.querySelectorAll('[data-placeholder]').forEach(el => {
                const key = el.getAttribute('data-placeholder');
                const text = getNestedProperty(translations, key);
                if (text !== null) el.placeholder = text;
            });
        }

        function getNestedProperty(obj, path) {
            if (!obj || !path) return null;
            return path.split('.').reduce((o, p) => (o && o[p] !== undefined) ? o[p] : null, obj);
        }
        
        async function loadAllPlacesFromServer() {
            console.log("[Client] loadAllPlacesFromServer called.");
            try {
                const response = await fetch(`${API_BASE}/api/places`);
                if (!response.ok) throw new Error('Failed to load places from server, status: ' + response.status);
                allPlacesData = await response.json();
                if (typeof allPlacesData !== 'object' || allPlacesData === null || Object.keys(allPlacesData).length === 0) { 
                    console.error("[Client] Invalid or empty places data received:", allPlacesData);
                    allPlacesData = { southwesternregion: [], northeasternregion: [], JungguDistrict: [] }; // 기본값 설정
                }
                console.log("[Client] loadAllPlacesFromServer success. Data keys:", Object.keys(allPlacesData));
            } catch (error) {
                console.error('[Client] loadAllPlacesFromServer error:', error);
                allPlacesData = { southwesternregion: [], northeasternregion: [], JungguDistrict: [] };
            }
        }
        
        function getAllPlacesArray() { 
            if (!allPlacesData || typeof allPlacesData !== 'object') {
                console.warn("[Client] getAllPlacesArray: allPlacesData is not valid. Returning empty array.");
                return [];
            }
            return Object.values(allPlacesData).flat().filter(p => p && p.id); 
        }

        async function loadUserBookmarks() {
            try {
                const response = await fetch(`${API_BASE}/api/bookmarks`);
                if (!response.ok) throw new Error('Failed to load bookmarks');
                userBookmarks = await response.json();
                if (!Array.isArray(userBookmarks)) userBookmarks = [];
            } catch (error) {
                console.error('[Client] loadUserBookmarks error:', error);
                userBookmarks = [];
            }
        }
        
        async function loadVisits() {
            try {
                const response = await fetch(`${API_BASE}/api/visits`);
                if (response.ok) {
                     visits = await response.json();
                     if (typeof visits !== 'object' || visits === null) visits = {};
                } else { visits = {}; }
            } catch (error) { 
                console.error('[Client] loadVisits error:', error);
                visits = {};
            }
        }
        
        function searchPlacesByRegion(regionKey) {
            console.log(`[Client] searchPlacesByRegion called with regionKey: ${regionKey}`);
            document.getElementById('regionFilter').value = regionKey;
            document.getElementById('searchInput').value = ''; 
            searchPlaces(true); 
        }

        async function searchPlaces(scrollToResults = true) {
            const keyword = document.getElementById('searchInput').value;
            const region = document.getElementById('regionFilter').value;
            console.log(`[Client] searchPlaces called. Keyword: "${keyword}", Region: "${region}", Scroll: ${scrollToResults}`);
            showLoading();
            try {
                const params = new URLSearchParams({ lang: currentLanguage });
                if (keyword) params.append('keyword', keyword);
                if (region && region !== 'all') params.append('region', region);
                
                console.log(`[Client] Fetching search results with params: ${params.toString()}`);
                const response = await fetch(`${API_BASE}/api/search?${params.toString()}`);
                if (!response.ok) throw new Error(`Search request failed: ${response.status} ${response.statusText}`);
                const places = await response.json();
                console.log(`[Client] Search results received (count: ${places.length}):`, places);
                
                const resultsGrid = document.getElementById('resultsGrid');
                const resultsSection = document.getElementById('searchResultsDisplay');
                
                displayPlaces(places, resultsGrid); 
                updateResultsTitle(places.length, keyword, region);
                resultsSection.style.display = 'block'; 

                if (scrollToResults && places && places.length > 0) { 
                    const header = document.querySelector('header');
                    const headerOffset = header ? header.offsetHeight : 70;
                    const elementPosition = resultsSection.getBoundingClientRect().top;
                    const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                    window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
                }
            } catch (error) {
                console.error('[Client] searchPlaces error:', error);
                document.getElementById('resultsGrid').innerHTML = `<p>${getNestedProperty(translations, 'error.search') || '검색 중 오류가 발생했습니다.'}</p>`;
                document.getElementById('searchResultsDisplay').style.display = 'block'; 
            } finally {
                hideLoading();
            }
        }

        function displayPlaces(places, gridElement) {
            console.log(`[Client] displayPlaces called for grid:`, gridElement, `with ${places ? places.length : 0} places.`);
            gridElement.innerHTML = ''; 
            if (!places || places.length === 0) {
                gridElement.innerHTML = `<p style="text-align: center; grid-column: 1/-1; padding: 40px;">${getNestedProperty(translations, 'status.noResults') || '표시할 관광지가 없습니다.'}</p>`;
                return;
            }
            places.forEach(place => {
                if (place && place.id) { 
                    gridElement.appendChild(createPlaceCard(place));
                } else {
                    console.warn("[Client] Invalid place data in displayPlaces:", place);
                }
            });
        }

        function createPlaceCard(place) {
            const card = document.createElement('div');
            card.className = 'place-card';
            
            const visitCount = visits[place.id] || 0;
            const name = (place.name && (place.name[currentLanguage] || place.name.ko)) || '이름 없음';
            const description = (place.description && (place.description[currentLanguage] || place.description.ko)) || '설명 없음';
            const mapButtonText = getNestedProperty(translations, 'placeCard.mapButton') || '지도 보기';
            const isBookmarked = userBookmarks.includes(place.id);
            const bookmarkTitle = isBookmarked ? (getNestedProperty(translations, 'placeCard.removeBookmark') || '즐겨찾기 제거') : (getNestedProperty(translations, 'placeCard.addBookmark') || '즐겨찾기 추가');

            card.innerHTML = `
                <div class="place-img" onclick="visitPlace('${place.id}', this.closest('.place-card'))">
                    <img src="${place.image || 'https://via.placeholder.com/300x200?text=No+Image'}" alt="${name}" onerror="this.src='https://via.placeholder.com/300x200?text=Image+Error'">
                    <div class="visit-count"><i class="fas fa-eye"></i> ${visitCount}</div>
                    <i class="fas fa-star bookmark-icon ${isBookmarked ? 'active' : ''}" title="${bookmarkTitle}" onclick="event.stopPropagation(); toggleBookmark('${place.id}', this);"></i>
                </div>
                <div class="place-content">
                    <h3>${name}</h3>
                    <p>${description}</p>
                </div>
                <div class="place-footer">
                    <a href="${place.mapLink || '#'}" target="_blank" class="map-btn" onclick="event.stopPropagation()"><i class="fas fa-map-marker-alt"></i> ${mapButtonText}</a>
                </div>
            `;
            return card;
        }
        
        async function toggleBookmark(placeId, iconElement) {
            if (!placeId || !iconElement) return;
            const isActive = iconElement.classList.contains('active');
            const method = isActive ? 'DELETE' : 'POST';
            const url = isActive ? `${API_BASE}/api/bookmark/${placeId}` : `${API_BASE}/api/bookmark`;
            
            try {
                const response = await fetch(url, {
                    method: method,
                    headers: method === 'POST' ? { 'Content-Type': 'application/json' } : {},
                    body: method === 'POST' ? JSON.stringify({ placeId }) : null,
                });
                if (!response.ok) throw new Error(`Bookmark operation failed: ${response.statusText}`);
                if (isActive) {
                    userBookmarks = userBookmarks.filter(id => id !== placeId);
                    iconElement.classList.remove('active');
                    iconElement.title = getNestedProperty(translations, 'placeCard.addBookmark') || '즐겨찾기 추가';
                } else {
                    userBookmarks.push(placeId);
                    iconElement.classList.add('active');
                    iconElement.title = getNestedProperty(translations, 'placeCard.removeBookmark') || '즐겨찾기 제거';
                }
                await loadBookmarkedPlacesDisplay(); 
            } catch (error) {
                console.error('[Client] toggleBookmark error:', error);
                alert(getNestedProperty(translations, 'error.bookmarkToggle') || '즐겨찾기 작업 중 오류가 발생했습니다.');
            }
        }

        async function visitPlace(placeId, cardElement) {
            if (!placeId) return;
            try {
                const response = await fetch(`${API_BASE}/api/places/${placeId}/visit`, { method: 'POST' });
                if (response.ok) {
                    const result = await response.json();
                    visits[placeId] = result.visitCount;
                    if (cardElement) {
                        const visitCountEl = cardElement.querySelector('.visit-count');
                        if (visitCountEl) visitCountEl.innerHTML = `<i class="fas fa-eye"></i> ${result.visitCount}`;
                    }
                    await loadStats(); 
                    await loadPopularPlaces();
                }
            } catch (error) { console.error('[Client] visitPlace error:', error); }
        }

        function updateResultsTitle(count, keyword, region) {
            const titleEl = document.getElementById('resultsTitle');
            const countEl = document.getElementById('resultsCount');
            let titleTextKey = (!keyword && (!region || region === 'all')) ? 'searchResults.allPlacesTitle' : 'searchResults.title';
            titleEl.textContent = getNestedProperty(translations, titleTextKey) || '관광지';
            countEl.textContent = `${getNestedProperty(translations, 'searchResults.countPrefix') || '총'} ${count} ${getNestedProperty(translations, 'searchResults.countSuffix') || '개의 관광지가 있습니다'}`;
        }
        
        async function loadPopularPlaces() {
            console.log("[Client] loadPopularPlaces called.");
            const popularGrid = document.getElementById('popularGrid');
            popularGrid.innerHTML = ''; 
            try {
                const statsResponse = await fetch(`${API_BASE}/api/stats`);
                if (!statsResponse.ok) throw new Error('Failed to load stats for popular places, status: ' + statsResponse.status);
                const stats = await statsResponse.json();
                console.log("[Client] Stats for popular places:", stats);

                if (stats.popularPlaces && stats.popularPlaces.length > 0) {
                    const allCurrentPlaces = getAllPlacesArray(); 
                    if (allCurrentPlaces.length === 0 && allPlacesData === null) { // allPlacesData가 아직 로드 시도 전이면
                        console.warn("[Client] loadPopularPlaces: allPlacesData is null, waiting for it to load.");
                        popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'error.loadPopular') || '인기 관광지 정보를 불러오는 중입니다...'}</p>`;
                        return; 
                    }
                     if (allCurrentPlaces.length === 0 && allPlacesData !== null) { // 로드 시도했으나 비어있다면
                        console.warn("[Client] loadPopularPlaces: allPlacesData is loaded but empty. Cannot show popular places details.");
                        popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noPopularPlacesDetail') || '인기 관광지 상세 정보를 찾을 수 없습니다 (데이터 부족).'}</p>`;
                        return;
                    }
                    
                    const popularToDisplay = stats.popularPlaces.slice(0, 3); 
                    let displayedCount = 0;
                    for (const popular of popularToDisplay) {
                        const placeDetail = allCurrentPlaces.find(p => p.id === popular.id);
                        if (placeDetail) {
                            popularGrid.appendChild(createPlaceCard(placeDetail));
                            displayedCount++;
                        } else {
                            console.warn(`[Client] Popular place ID ${popular.id} not found in allCurrentPlaces.`);
                        }
                    }
                    if (displayedCount === 0 && popularToDisplay.length > 0) {
                         popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noPopularPlacesDetail') || '인기 관광지 상세 정보를 찾을 수 없습니다.'}</p>`;
                    } else if (popularToDisplay.length === 0) {
                         popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noPopularPlaces') || '인기 관광지 정보가 없습니다.'}</p>`;
                    }

                } else {
                    popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noPopularPlaces') || '인기 관광지 정보가 없습니다.'}</p>`;
                }
            } catch (error) {
                console.error('[Client] loadPopularPlaces error:', error);
                popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'error.loadPopular') || '인기 관광지 로딩 중 오류 발생.'}</p>`;
            }
        }

        async function loadBookmarkedPlacesDisplay() {
            console.log("[Client] loadBookmarkedPlacesDisplay called.");
            const bookmarksGrid = document.getElementById('bookmarksGrid');
            bookmarksGrid.innerHTML = '';
            if (userBookmarks.length === 0) {
                bookmarksGrid.innerHTML = `<p style="text-align:center;">${getNestedProperty(translations, 'status.noBookmarks') || '즐겨찾기한 관광지가 없습니다.'}</p>`;
                return;
            }
            const allCurrentPlaces = getAllPlacesArray();
            if (allCurrentPlaces.length === 0 && allPlacesData === null) {
                console.warn("[Client] loadBookmarkedPlacesDisplay: allPlacesData is null, waiting.");
                bookmarksGrid.innerHTML = `<p>${getNestedProperty(translations, 'error.loadBookmarks') || '즐겨찾기 정보를 불러오는 중입니다...'}</p>`;
                return;
            }
            if (allCurrentPlaces.length === 0 && allPlacesData !== null) {
                 console.warn("[Client] loadBookmarkedPlacesDisplay: allPlacesData is empty.");
                bookmarksGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noBookmarksDetail') || '즐겨찾기한 관광지 상세 정보를 찾을 수 없습니다 (데이터 부족).'}</p>`;
                return;
            }

            let displayedCount = 0;
            userBookmarks.forEach(bookmarkId => {
                const placeDetail = allCurrentPlaces.find(p => p.id === bookmarkId);
                if (placeDetail) {
                    bookmarksGrid.appendChild(createPlaceCard(placeDetail));
                    displayedCount++;
                } else {
                    console.warn(`[Client] Bookmarked place ID ${bookmarkId} not found in allCurrentPlaces.`);
                }
            });
             if (displayedCount === 0 && userBookmarks.length > 0) {
                 bookmarksGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noBookmarksDetail') || '즐겨찾기한 관광지 상세 정보를 찾을 수 없습니다.'}</p>`;
            }
        }

        async function getRecommendation() {
            const theme = document.getElementById('themeSelect').value;
            const duration = document.getElementById('durationSelect').value;
            showLoading();
            try {
                const params = new URLSearchParams({ theme, duration, lang: currentLanguage });
                const response = await fetch(`${API_BASE}/api/recommend?${params.toString()}`);
                if (!response.ok) throw new Error('Recommendation request failed');
                const recommendation = await response.json();
                displayRecommendation(recommendation);
            } catch (error) {
                console.error('[Client] getRecommendation error:', error);
                const resultBox = document.getElementById('aiCourseBox');
                resultBox.innerHTML = `<p>${getNestedProperty(translations, 'error.recommend') || '추천 코스 생성 중 오류 발생.'}</p>`;
                resultBox.style.display = 'block';
            } finally {
                hideLoading();
            }
        }

        function displayRecommendation(recommendation) {
            const resultBox = document.getElementById('aiCourseBox');
            const places = recommendation.recommendedPlaces;
            if (!places || places.length === 0) {
                resultBox.innerHTML = `<p style="text-align: center;">${getNestedProperty(translations, 'status.noRecommendation') || '추천할 수 있는 관광지가 없습니다.'}</p>`;
                resultBox.style.display = 'block'; return;
            }
            const themeEmoji = { nature: "🌿", history: "🏛️", culture: "🎭", shopping: "🛍️" };
            const durationText = recommendation.duration === "half" ? (getNestedProperty(translations, 'recommend.durations.half') || "반나절") : (getNestedProperty(translations, 'recommend.durations.full') || "하루 종일");
            const themeText = getNestedProperty(translations, `recommend.themes.${recommendation.theme}`) || recommendation.theme;
            let courseHTML = `<h3>${themeEmoji[recommendation.theme] || '✨'} ${durationText} ${themeText} ${getNestedProperty(translations, 'recommend.courseTitleSuffix') || '테마 추천 코스'}</h3><div>`;
            places.forEach((place, index) => {
                const name = (place.name && (place.name[currentLanguage] || place.name.ko)) || '이름 없음';
                const description = ((place.description && (place.description[currentLanguage] || place.description.ko)) || '설명 없음').substring(0, 80) + '...';
                const imageSrc = place.image || 'https://via.placeholder.com/60x60?text=No+Image';
                courseHTML += `<div class="course-item" onclick="visitPlace('${place.id}', this)">
                                <img src="${imageSrc}" alt="${name}" onerror="this.src='https://via.placeholder.com/60x60?text=Error'">
                                <div class="course-info"><h4>${index + 1}. ${name}</h4><p>${description}</p></div></div>`;
            });
            const placeNamesForMap = places.map(p => (p.name && (p.name[currentLanguage] || p.name.ko)) || '');
            const gmapQuery = `https://www.google.com/maps/search/?api=1&query=${placeNamesForMap.filter(name => name).map(encodeURIComponent).join(' AND ')}`;
            courseHTML += `</div><a href="${gmapQuery}" target="_blank" class="map-link"><i class="fas fa-route"></i> ${getNestedProperty(translations, 'recommend.viewMapButton') || '지도에서 전체 코스 보기'}</a>`;
            resultBox.innerHTML = courseHTML; resultBox.style.display = 'block';
        }

        async function loadStats() {
            try {
                const response = await fetch(`${API_BASE}/api/stats`);
                if (!response.ok) throw new Error('Failed to load stats');
                const stats = await response.json();
                updateStatsDisplay(stats);
            } catch (error) { console.error('[Client] loadStats error:', error); }
        }

        function updateStatsDisplay(stats) {
            document.getElementById('totalPlaces').textContent = stats.totalPlaces || 0;
            document.getElementById('totalVisits').textContent = stats.totalVisits || 0;
            const mostPopularEl = document.getElementById('mostPopularPlaceName');
            if (stats.popularPlaces && stats.popularPlaces.length > 0) {
                const popularPlaceId = stats.popularPlaces[0].id;
                const allCurrentPlaces = getAllPlacesArray();
                const popularPlaceDetail = allCurrentPlaces.find(p => p.id === popularPlaceId);
                if (popularPlaceDetail) mostPopularEl.textContent = (popularPlaceDetail.name && (popularPlaceDetail.name[currentLanguage] || popularPlaceDetail.name.ko)) || '-';
                else mostPopularEl.textContent = '-';
            } else { mostPopularEl.textContent = '-'; }
            document.getElementById('activeUsers').textContent = Math.floor(Math.random() * 50) + 10; 
        }
    </script>
</body>
</html>