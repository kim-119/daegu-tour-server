<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ëŒ€êµ¬ íˆ¬ì–´ ê°€ì´ë“œ - ì•„ë¦„ë‹¤ìš´ ëŒ€êµ¬ ì—¬í–‰ì˜ ì‹œì‘</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --primary: #e74c3c; /* ì£¼ìš” ìƒ‰ìƒ (ë¹¨ê°„ ê³„ì—´) */
            --primary-dark: #c0392b;
            --secondary: #3498db; /* ë³´ì¡° ìƒ‰ìƒ (íŒŒë€ ê³„ì—´) */
            --secondary-dark: #2980b9;
            --accent: #f39c12; /* ê°•ì¡° ìƒ‰ìƒ (ì£¼í™© ê³„ì—´) */
            --dark: #2c3e50; /* ì–´ë‘ìš´ í…ìŠ¤íŠ¸/ë°°ê²½ */
            --light: #ecf0f1; /* ë°ì€ ë°°ê²½ */
            --gray: #7f8c8d; /* íšŒìƒ‰ í…ìŠ¤íŠ¸ */
            --white: #ffffff;
            --blue: #2563eb; /* ë¡œê³  ë“±ì— ì‚¬ìš©ë˜ëŠ” íŒŒë€ìƒ‰ */
            --bookmark-active: #f1c40f; /* í™œì„±í™”ëœ ë¶ë§ˆí¬ ë³„ ìƒ‰ìƒ (ë…¸ë€ìƒ‰) */
        }
        
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        html, body { 
            width: 100%; 
            background-color: var(--light); 
            font-family: 'Noto Sans KR', sans-serif; 
            color: var(--dark);
            line-height: 1.6;
        }
        
        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        header {
            background-color: var(--white);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .logo { display: flex; align-items: center; gap: 10px; }
        .logo img { height: 40px; width: auto; }
        .logo h1 { font-size: 1.5rem; font-weight: 700; color: var(--blue); }
        
        .language-selector { display: flex; align-items: center; gap: 10px; margin-left: auto; margin-right: 20px; }
        .language-selector select { padding: 8px 12px; border: 1px solid #ddd; border-radius: 5px; background-color: var(--white); color: var(--dark); font-size: 0.9rem; }
        
        nav ul { display: flex; list-style: none; gap: 20px; /* ê°„ê²© ì•½ê°„ ì¤„ì„ */ }
        nav a { text-decoration: none; color: var(--dark); font-weight: 500; font-size: 0.95rem; /* ì•½ê°„ ì‘ê²Œ */ transition: color 0.3s; position: relative; }
        nav a:hover { color: var(--primary); }
        nav a::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -5px; left: 0; background-color: var(--primary); transition: width 0.3s; }
        nav a:hover::after { width: 100%; }
        
        .mobile-menu-btn { display: none; background: none; border: none; font-size: 1.5rem; color: var(--dark); cursor: pointer; }

        /* ì„¹ì…˜ ê³µí†µ ìŠ¤íƒ€ì¼ */
        .section { padding: 60px 5%; max-width: 1400px; margin: 0 auto; } /* íŒ¨ë”© ì•½ê°„ ì¤„ì„ */
        .section-title { text-align: center; margin-bottom: 40px; } /* ë§ˆì§„ ì•½ê°„ ì¤„ì„ */
        .section-title h2 { font-size: 2.2rem; color: var(--dark); margin-bottom: 10px; position: relative; display: inline-block; } /* í¬ê¸°, ë§ˆì§„ ì•½ê°„ ì¤„ì„ */
        .section-title h2::after { content: ''; position: absolute; width: 40px; height: 3px; background-color: var(--primary); bottom: -8px; left: 50%; transform: translateX(-50%); }
        .section-title p { font-size: 1rem; color: var(--gray); max-width: 600px; margin: 0 auto; } /* í¬ê¸°, ë„ˆë¹„ ì•½ê°„ ì¤„ì„ */
        
        /* ê²€ìƒ‰ ì„¹ì…˜ */
        .search-section { background-color: var(--white); padding: 25px 5%; margin-top: 70px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .search-container { max-width: 800px; margin: 0 auto; display: flex; gap: 10px; flex-wrap: wrap; align-items: center; justify-content: center; }
        .search-input { flex: 1; min-width: 180px; padding: 10px 15px; border: 1px solid #ddd; border-radius: 20px; font-size: 0.95rem; outline: none; }
        .search-input:focus { border-color: var(--primary); box-shadow: 0 0 0 2px rgba(231, 76, 60, 0.1); }
        .filter-select { padding: 10px 15px; border: 1px solid #ddd; border-radius: 20px; background-color: var(--white); font-size: 0.95rem; outline: none; }
        .search-btn { padding: 10px 20px; background-color: var(--primary); color: var(--white); border: none; border-radius: 20px; font-size: 0.95rem; cursor: pointer; transition: all 0.3s; }
        .search-btn:hover { background-color: var(--primary-dark); transform: translateY(-1px); }
        
        /* ë©”ì¸ ë°°ë„ˆ */
        .hero-banner { height: 65vh; background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('ëŒ€êµ¬ ì§€ë„.png'); background-size: cover; background-position: center; display: flex; align-items: center; justify-content: center; text-align: center; color: var(--white); padding: 0 20px; }
        .hero-content { max-width: 700px; }
        .hero-content h2 { font-size: 2.5rem; margin-bottom: 15px; text-shadow: 1px 1px 3px rgba(0,0,0,0.5); }
        .hero-content p { font-size: 1.1rem; margin-bottom: 25px; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); }
        .btn { display: inline-block; padding: 10px 25px; background-color: var(--primary); color: var(--white); text-decoration: none; border-radius: 5px; font-weight: 500; transition: all 0.3s; border: none; cursor: pointer; margin: 5px; font-size: 0.95rem; }
        .btn:hover { background-color: var(--primary-dark); transform: translateY(-2px); }
        .btn-outline { background-color: transparent; border: 2px solid var(--white); }
        .btn-outline:hover { background-color: var(--white); color: var(--primary); }

        /* ì§€ì—­ë³„ ê´€ê´‘ ì„¹ì…˜ */
        .regions-section { background-color: var(--white); }
        .regions-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; } /* ì¹´ë“œ í¬ê¸°, ê°„ê²© ì¡°ì • */
        .region-card { background-color: var(--white); border-radius: 8px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.08); transition: all 0.3s; cursor: pointer; }
        .region-card:hover { transform: translateY(-8px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .region-img { 
            height: 200px; /* ì‚¬ì§„ ì˜ë¦¼ ë¬¸ì œ ê°œì„  */
            overflow: hidden;
            position: relative; 
        }
        .region-img img { 
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center; /* ì‚¬ì§„ ì˜ë¦¼ ë¬¸ì œ ê°œì„  */
            transition: transform 0.4s;
        }
        .region-card:hover .region-img img { transform: scale(1.08); }
        .region-content { padding: 18px; text-align: center; }
        .region-content h3 { font-size: 1.3rem; margin-bottom: 8px; color: var(--dark); }
        .region-content p { color: var(--gray); margin-bottom: 12px; font-size: 0.9rem; }
        .region-icon { font-size: 2.2rem; color: var(--primary); margin-bottom: 12px; }
        
        /* ê²€ìƒ‰ ê²°ê³¼, ì¸ê¸° ê´€ê´‘ì§€, ì¦ê²¨ì°¾ê¸° ëª©ë¡ ê³µí†µ ê·¸ë¦¬ë“œ */
        .results-grid, .popular-grid, .bookmarks-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }
        
        /* ê´€ê´‘ì§€ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .place-card { background-color: var(--white); border-radius: 8px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.08); transition: all 0.3s; display: flex; flex-direction: column; }
        .place-card:hover { transform: translateY(-8px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .place-img { 
            height: 200px; /* ì‚¬ì§„ ì˜ë¦¼ ë¬¸ì œ ê°œì„  */
            overflow: hidden; 
            position: relative; 
            cursor: pointer; 
        }
        .place-img img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            object-position: center; /* ì‚¬ì§„ ì˜ë¦¼ ë¬¸ì œ ê°œì„  */
            transition: transform 0.4s; 
        }
        .place-card:hover .place-img img { transform: scale(1.08); }
        
        .visit-count { position: absolute; top: 8px; right: 8px; background-color: rgba(0,0,0,0.6); color: var(--white); padding: 4px 8px; border-radius: 12px; font-size: 0.75rem; }
        .bookmark-icon { position: absolute; top: 8px; left: 8px; font-size: 1.5rem; color: var(--gray); cursor: pointer; transition: color 0.2s, transform 0.2s; text-shadow: 0 0 3px rgba(0,0,0,0.3); }
        .bookmark-icon.active { color: var(--bookmark-active); transform: scale(1.1); }
        .bookmark-icon:hover { transform: scale(1.2); }

        .place-content { padding: 18px; flex-grow: 1; display: flex; flex-direction: column; }
        .place-content h3 { font-size: 1.2rem; margin-bottom: 8px; color: var(--dark); }
        .place-content p { color: var(--gray); margin-bottom: 12px; font-size: 0.9rem; line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; flex-grow: 1; }
        .place-footer { display: flex; justify-content: flex-end; /* ì§€ë„ ë²„íŠ¼ë§Œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ */ align-items: center; padding-top: 12px; border-top: 1px solid #eee; margin-top: auto; }
        .map-btn { color: var(--secondary); text-decoration: none; font-weight: 500; display: flex; align-items: center; gap: 4px; font-size: 0.9rem; }
        .map-btn:hover { color: var(--secondary-dark); }

        /* ì¸ê¸° ê´€ê´‘ì§€ ì„¹ì…˜ */
        .popular-section { background-color: #f8f9fa; }
        
        /* ì¦ê²¨ì°¾ê¸° ì„¹ì…˜ */
        .my-bookmarks-section { background-color: var(--light); } 

        /* AI ì¶”ì²œ ì„¹ì…˜ */
        .ai-recommend-section { background-color: var(--white); }
        .ai-recommend-container { max-width: 900px; margin: 0 auto; text-align: center; }
        .ai-form { display: flex; gap: 12px; margin-bottom: 25px; justify-content: center; flex-wrap: wrap; }
        .form-group { flex: 1; min-width: 180px; max-width: 220px; }
        .form-group label { display: block; margin-bottom: 6px; font-weight: 500; color: var(--dark); text-align: left; font-size: 0.9rem; }
        .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 0.95rem; color: var(--dark); background-color: var(--white); }
        .ai-result { background-color: #f8f9fa; border-radius: 8px; padding: 18px; margin-top: 18px; text-align: left; }
        .ai-result h3 { color: var(--primary); margin-bottom: 12px; font-size: 1.2rem; text-align: center; }
        .course-item { background-color: var(--white); padding: 12px; border-radius: 5px; margin-bottom: 8px; border-left: 3px solid var(--primary); display: flex; align-items: center; gap: 12px; cursor: pointer; }
        .course-item img { width: 50px; height: 50px; object-fit: cover; border-radius: 4px; }
        .course-info { flex: 1; }
        .course-info h4 { margin-bottom: 4px; color: var(--dark); font-size: 1rem; }
        .course-info p { font-size: 0.85rem; color: var(--gray); -webkit-line-clamp: 2; display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; }
        .map-link { display: inline-block; margin-top: 12px; color: var(--secondary); text-decoration: none; font-weight: 500; text-align: center; width: 100%; font-size: 0.95rem; }
        .map-link:hover { text-decoration: underline; }
        
        /* í†µê³„ ì„¹ì…˜ */
        .stats-section { background-color: var(--dark); color: var(--white); }
        .stats-container { max-width: 1100px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 25px; }
        .stat-card { text-align: center; padding: 25px; background-color: rgba(255,255,255,0.08); border-radius: 8px; }
        .stat-card i { font-size: 2.5rem; color: var(--primary); margin-bottom: 12px; }
        .stat-card h3 { font-size: 1.8rem; margin-bottom: 8px; }
        .stat-card p { color: var(--light); font-size: 0.9rem; }
        
        /* í‘¸í„° ì„¹ì…˜ */
        footer { background-color: var(--dark); color: var(--light); padding: 50px 5% 25px; }
        .footer-container { max-width: 1400px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; }
        .footer-col h3 { font-size: 1.2rem; margin-bottom: 18px; color: var(--white); position: relative; padding-bottom: 8px; }
        .footer-col h3::after { content: ''; position: absolute; width: 35px; height: 2px; background-color: var(--primary); bottom: 0; left: 0; }
        .footer-col p { color: var(--gray); margin-bottom: 12px; font-size: 0.9rem; }
        .footer-links { list-style: none; padding-left: 0; }
        .footer-links li { margin-bottom: 8px; }
        .footer-links a { color: var(--gray); text-decoration: none; transition: color 0.3s; font-size: 0.9rem; }
        .footer-links a:hover { color: var(--primary); }
        .contact-info { display: flex; align-items: center; gap: 8px; margin-bottom: 12px; }
        .contact-info i { color: var(--primary); font-size: 1rem; width: 18px; text-align: center; }
        .social-links { display: flex; gap: 12px; margin-top: 18px; }
        .social-links a { display: flex; align-items: center; justify-content: center; width: 36px; height: 36px; background-color: rgba(255,255,255,0.1); border-radius: 50%; color: var(--white); transition: all 0.3s; font-size: 0.9rem; }
        .social-links a:hover { background-color: var(--primary); transform: translateY(-2px); }
        .copyright { text-align: center; padding-top: 25px; margin-top: 25px; border-top: 1px solid rgba(255,255,255,0.1); color: var(--gray); font-size: 0.85rem; }

        /* ë¡œë”© í™”ë©´ */
        .loading-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(255,255,255,0.9); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 2000; }
        .loading-spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 15px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 992px) { 
            nav ul { gap: 15px; }
            nav a { font-size: 0.9rem; }
            .section-title h2 { font-size: 2rem; }
            .hero-content h2 { font-size: 2.2rem; }
        }

        @media (max-width: 768px) { 
            .header-container { padding: 12px 15px; height: 60px; } 
            .logo h1 { font-size: 1.3rem; }
            .language-selector { margin-right: 8px; }
            .language-selector select { padding: 6px 10px; font-size: 0.85rem; }
            nav { display: none; position: absolute; top: 60px; left: 0; width: 100%; background-color: var(--white); box-shadow: 0 5px 10px rgba(0,0,0,0.1); padding: 15px; }
            nav.active { display: block; }
            nav ul { flex-direction: column; gap: 12px; }
            .mobile-menu-btn { display: block; }
            .section { padding: 40px 15px; }
            .section-title h2 { font-size: 1.8rem; }
            .section-title p { font-size: 0.95rem; }
            .search-section { padding: 20px 15px; margin-top: 60px; }
            .search-container { flex-direction: column; }
            .search-input, .filter-select, .search-btn { min-width: 100%; width: 100%; font-size: 0.9rem; padding: 10px 12px; }
            .hero-banner { height: 55vh; }
            .hero-content h2 { font-size: 1.8rem; }
            .hero-content p { font-size: 1rem; }
            .btn { padding: 8px 20px; font-size: 0.9rem; }
            .regions-grid, .results-grid, .popular-grid, .bookmarks-grid { grid-template-columns: 1fr; gap: 20px; } 
            .place-img, .region-img { height: 180px; } /* ëª¨ë°”ì¼ì—ì„œëŠ” ì´ë¯¸ì§€ ë†’ì´ ë‹¤ì‹œ ì¡°ì • */
            .place-content h3, .region-content h3 { font-size: 1.1rem; }
            .place-content p, .region-content p { font-size: 0.85rem; }
            .ai-form { flex-direction: column; }
            .course-item { flex-direction: column; text-align: center; }
            .stats-container { grid-template-columns: 1fr; } 
            .footer-container { grid-template-columns: 1fr; } 
        }
    </style>
</head>
<body>
    <!-- í—¤ë” -->
    <header>
        <div class="header-container">
            <div class="logo">
                <img src="/ëŒ€êµ¬ ë§ˆìŠ¤ì½”íŠ¸.png" alt="ëŒ€êµ¬ íˆ¬ì–´ ë¡œê³ " style="height: 40px;">

                <h1 id="siteTitle" data-text="title">ëŒ€êµ¬ íˆ¬ì–´ ê°€ì´ë“œ</h1>
            </div>
            <div class="language-selector">
                <select id="languageSelect" onchange="changeLanguage()">
                    <option value="ko">í•œêµ­ì–´</option>
                    <option value="en">English</option>
                    <option value="ja">æ—¥æœ¬èª</option>
                    <option value="zh">ä¸­æ–‡</option>
                </select>
            </div>
            <nav id="mainNav">
                <ul>
                    <li><a href="#home" data-text="nav.home">í™ˆ</a></li>
                    <li><a href="#regions" data-text="nav.regions">ì§€ì—­ë³„ ê´€ê´‘</a></li>
                    <li><a href="#popular" data-text="nav.popular">ì¸ê¸° ê´€ê´‘ì§€</a></li>
                    <li><a href="#my-bookmarks" data-text="nav.bookmarks">ë‚´ ì¦ê²¨ì°¾ê¸°</a></li>
                    <li><a href="#recommend" data-text="nav.recommend">ì¶”ì²œ ì½”ìŠ¤</a></li>
                    <li><a href="#stats" data-text="nav.stats">ì—¬í–‰ í†µê³„</a></li>
                </ul>
            </nav>
            <button class="mobile-menu-btn" id="mobileMenuBtn"><i class="fas fa-bars"></i></button>
        </div>
    </header>

    <!-- ë©”ì¸ ë°°ë„ˆ -->
    <section id="home" class="hero-banner">
        <div class="hero-content">
            <h2 id="heroTitle" data-text="hero.title">ëŒ€êµ¬ì˜ ì•„ë¦„ë‹¤ì›€ì„ ë°œê²¬í•˜ì„¸ìš”</h2>
            <p id="heroDescription" data-text="hero.description">ì—­ì‚¬ì ì¸ ëª…ì†Œë¶€í„° ìì—°ì˜ ê²½ì´ë¡œì›€, í™œê¸°ì°¬ ë„ì‹œ ìƒí™œê¹Œì§€ - ëŒ€êµ¬ì˜ ëª¨ë“  ê²ƒì„ ê²½í—˜í•´ë³´ì„¸ìš”</p>
            <div class="hero-buttons">
                <a href="#search" class="btn" data-text="hero.buttons.regions">ê´€ê´‘ì§€ ê²€ìƒ‰í•˜ê¸°</a>
                <a href="#recommend" class="btn btn-outline" data-text="hero.buttons.recommend">ì¶”ì²œ ì½”ìŠ¤ ë³´ê¸°</a>
            </div>
        </div>
    </section>

    <!-- ê²€ìƒ‰ ì„¹ì…˜ -->
    <section id="search" class="search-section">
        <div class="search-container">
            <input type="text" id="searchInput" class="search-input" placeholder="ê´€ê´‘ì§€ ê²€ìƒ‰..." data-placeholder="search.placeholder">
            <select id="regionFilter" class="filter-select">
                <option value="all" data-text="search.all">ì „ì²´ ì§€ì—­</option>
                <option value="southwesternregion" data-text="regions.southwesternregion_short">ë™ë‚¨/ì„œë‚¨ê¶Œ</option>
                <option value="northeasternregion" data-text="regions.northeasternregion_short">ë™ë¶ê¶Œ</option>
                <option value="JungguDistrict" data-text="regions.JungguDistrict_short">ì¤‘êµ¬ê¶Œ</option>
            </select>
            <button id="searchBtn" class="search-btn" data-text="search.button"><i class="fas fa-search"></i> ê²€ìƒ‰</button>
        </div>
    </section>

    <!-- ì§€ì—­ë³„ ê´€ê´‘ ì„¹ì…˜ -->
    <section id="regions" class="section regions-section">
        <div class="section-title">
            <h2 data-text="regions.title">ì§€ì—­ë³„ ê´€ê´‘ì§€</h2>
            <p data-text="regions.description">ëŒ€êµ¬ì˜ ë‹¤ì–‘í•œ ì§€ì—­ë³„ íŠ¹ìƒ‰ìˆëŠ” ê´€ê´‘ì§€ë¥¼ ë§Œë‚˜ë³´ì„¸ìš”</p>
        </div>
        <div class="regions-grid">
            <div class="region-card" onclick="searchPlacesByRegion('southwesternregion')">
                <div class="region-img"><img src="ë””ì•„í¬.jfif" alt="ë™ë‚¨/ì„œë‚¨ê¶Œ"></div>
                <div class="region-content">
                    <div class="region-icon"><i class="fas fa-leaf"></i></div>
                    <h3 data-text="regions.southwesternregion">ë™ë‚¨/ì„œë‚¨ê¶Œ</h3>
                    <p data-text="regions.southwesternregion_desc">ìì—°ê³¼ ë¬¸í™”ì˜ ì¡°í™”ë¥¼ ëŠë‚„ ìˆ˜ ìˆëŠ” ì§€ì—­</p>
                </div>
            </div>
            <div class="region-card" onclick="searchPlacesByRegion('northeasternregion')">
                <div class="region-img"><img src="ë™í™”ì‚¬.jpg" alt="ë™ë¶ê¶Œ"></div>
                <div class="region-content">
                    <div class="region-icon"><i class="fas fa-mountain"></i></div>
                    <h3 data-text="regions.northeasternregion">ë™ë¶ê¶Œ</h3>
                    <p data-text="regions.northeasternregion_desc">ì—­ì‚¬ì™€ ì „í†µì˜ ìˆ¨ê²°ì´ ì‚´ì•„ìˆëŠ” ì§€ì—­</p>
                </div>
            </div>
            <div class="region-card" onclick="searchPlacesByRegion('JungguDistrict')">
                <div class="region-img"><img src="ë™ì„±ë¡œ.jfif" alt="ì¤‘êµ¬ê¶Œ"></div>
                <div class="region-content">
                    <div class="region-icon"><i class="fas fa-city"></i></div>
                    <h3 data-text="regions.JungguDistrict">ì¤‘êµ¬ê¶Œ</h3>
                    <p data-text="regions.JungguDistrict_desc">ë„ì‹¬ ì† ë¬¸í™”ì™€ ì‡¼í•‘ì˜ ì¤‘ì‹¬ì§€</p>
                </div>
            </div>
        </div>
    </section>

    <!-- ì¸ê¸° ê´€ê´‘ì§€ ì„¹ì…˜ -->
    <section id="popular" class="section popular-section">
        <div class="section-title">
            <h2 data-text="popular.title">ì¸ê¸° ê´€ê´‘ì§€</h2>
            <p data-text="popular.description">ëŒ€êµ¬ì—ì„œ ê°€ì¥ ì‚¬ë‘ë°›ëŠ” ê´€ê´‘ì§€ë¥¼ ì†Œê°œí•©ë‹ˆë‹¤</p>
        </div>
        <div id="popularGrid" class="popular-grid"></div>
    </section>

    <!-- ë‚´ ì¦ê²¨ì°¾ê¸° ì„¹ì…˜ -->
    <section id="my-bookmarks" class="section my-bookmarks-section">
        <div class="section-title">
            <h2 data-text="myBookmarks.title">ë‚´ ì¦ê²¨ì°¾ê¸°</h2>
            <p data-text="myBookmarks.description">ì¦ê²¨ì°¾ê¸°í•œ ê´€ê´‘ì§€ ëª©ë¡ì…ë‹ˆë‹¤.</p>
        </div>
        <div id="bookmarksGrid" class="bookmarks-grid"></div>
    </section>

    <!-- ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ ì„¹ì…˜ -->
    <section id="searchResultsDisplay" class="results-section section" style="display:none;">
        <div class="results-container">
            <div class="results-title">
                <h2 id="resultsTitle" data-text="searchResults.title">ê²€ìƒ‰ ê²°ê³¼</h2>
                <p id="resultsCount"></p>
            </div>
            <div id="resultsGrid" class="results-grid"></div>
        </div>
    </section>

    <!-- AI ì¶”ì²œ ì½”ìŠ¤ ì„¹ì…˜ -->
    <section id="recommend" class="ai-recommend-section section">
        <div class="ai-recommend-container">
            <div class="section-title">
                <h2 data-text="recommend.title">AI ë§ì¶¤ ì½”ìŠ¤ ì¶”ì²œ</h2>
                <p data-text="recommend.description">ë‹¹ì‹ ì˜ ì·¨í–¥ì— ë§ëŠ” ìµœì ì˜ ì—¬í–‰ ì½”ìŠ¤ë¥¼ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤</p>
            </div>
            <div class="ai-form">
                <div class="form-group">
                    <label for="themeSelect" data-text="recommend.theme">ì—¬í–‰ í…Œë§ˆ</label>
                    <select id="themeSelect">
                        <option value="nature" data-text="recommend.themes.nature">ğŸŒ¿ ìì—° íë§</option>
                        <option value="history" data-text="recommend.themes.history">ğŸ›ï¸ ì—­ì‚¬ ë¬¸í™”</option>
                        <option value="culture" data-text="recommend.themes.culture">ğŸ­ ë¬¸í™” ì²´í—˜</option>
                        <option value="shopping" data-text="recommend.themes.shopping">ğŸ›ï¸ ì‡¼í•‘ ë§›ì§‘</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="durationSelect" data-text="recommend.duration">ì—¬í–‰ ê¸°ê°„</label>
                    <select id="durationSelect">
                        <option value="half" data-text="recommend.durations.half">ë°˜ë‚˜ì ˆ ì½”ìŠ¤</option>
                        <option value="full" data-text="recommend.durations.full">í•˜ë£¨ ì¢…ì¼</option>
                    </select>
                </div>
                <div class="form-group" style="align-self: flex-end;">
                    <button class="btn" onclick="getRecommendation()" data-text="recommend.button"><i class="fas fa-magic"></i> ì½”ìŠ¤ ì¶”ì²œë°›ê¸°</button>
                </div>
            </div>
            <div id="aiCourseBox" class="ai-result" style="display: none;"></div>
        </div>
    </section>

    <!-- í†µê³„ ì„¹ì…˜ -->
    <section id="stats" class="stats-section section">
        <div class="section-title">
             <h2 data-text="stats.title" style="color: var(--white);">ì—¬í–‰ í†µê³„</h2>
             <p data-text="stats.description" style="color: var(--light);">ëŒ€êµ¬ ê´€ê´‘ì˜ ë‹¤ì–‘í•œ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”</p>
        </div>
        <div class="stats-container">
            <div class="stat-card"><i class="fas fa-map-marked-alt"></i><h3 id="totalPlaces">0</h3><p data-text="stats.totalPlaces">ì´ ê´€ê´‘ì§€</p></div>
            <div class="stat-card"><i class="fas fa-eye"></i><h3 id="totalVisits">0</h3><p data-text="stats.totalVisits">ì´ ì¡°íšŒìˆ˜</p></div>
            <div class="stat-card"><i class="fas fa-star"></i><h3 id="mostPopularPlaceName">-</h3><p data-text="stats.mostPopular">ê°€ì¥ ì¸ê¸°ìˆëŠ” ê³³</p></div>
            <div class="stat-card"><i class="fas fa-users"></i><h3 id="activeUsers">0</h3><p data-text="stats.activeUsers">ì˜¤ëŠ˜ ë°©ë¬¸ì (ì˜ˆì‹œ)</p></div>
        </div>
    </section>

    <!-- í‘¸í„° ì„¹ì…˜ -->
    <footer>
        <div class="footer-container">
            <div class="footer-col">
                <h3 data-text="footer.companyName">ëŒ€êµ¬ íˆ¬ì–´ ê°€ì´ë“œ</h3>
                <p data-text="footer.description">ëŒ€êµ¬ì˜ ì•„ë¦„ë‹¤ìš´ ê´€ê´‘ì§€ì™€ ë¬¸í™”ë¥¼ ì†Œê°œí•˜ëŠ” ê³µì‹ ê°€ì´ë“œì…ë‹ˆë‹¤. ì—­ì‚¬ì ì¸ ëª…ì†Œë¶€í„° ìì—° ê²½ê´€, ì‡¼í•‘ê³¼ ë§›ì§‘ê¹Œì§€ ëŒ€êµ¬ì˜ ëª¨ë“  ê²ƒì„ ê²½í—˜í•´ë³´ì„¸ìš”.</p>
                <div class="social-links">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" aria-label="Youtube"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            <div class="footer-col">
                <h3 data-text="footer.quickLinks">ë¹ ë¥¸ ë§í¬</h3>
                <ul class="footer-links">
                    <li><a href="#home" data-text="nav.home">í™ˆ</a></li>
                    <li><a href="#regions" data-text="nav.regions">ì§€ì—­ë³„ ê´€ê´‘</a></li>
                    <li><a href="#popular" data-text="nav.popular">ì¸ê¸° ê´€ê´‘ì§€</a></li>
                    <li><a href="#my-bookmarks" data-text="nav.bookmarks">ë‚´ ì¦ê²¨ì°¾ê¸°</a></li>
                    <li><a href="#recommend" data-text="nav.recommend">ì¶”ì²œ ì½”ìŠ¤</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3 data-text="footer.contactUs">ì—°ë½ì²˜</h3>
                <div class="contact-info"><i class="fas fa-map-marker-alt"></i><p data-text="footer.address">ëŒ€êµ¬ê´‘ì—­ì‹œ ì¤‘êµ¬ ë™ì„±ë¡œ 1ê¸¸</p></div>
                <div class="contact-info"><i class="fas fa-phone"></i><p data-text="footer.phone">+82 53-123-4567</p></div>
                <div class="contact-info"><i class="fas fa-envelope"></i><p data-text="footer.email">info@daegutour.com</p></div>
            </div>
        </div>
        <div class="copyright">
            <p data-text="footer.copyright">&copy; 2025 ëŒ€êµ¬ íˆ¬ì–´ ê°€ì´ë“œ. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loadingScreen" class="loading-screen"><div class="loading-spinner"></div><p data-text="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p></div>

    <script>
        let currentLanguage = 'ko';
        let translations = {};
        let allPlacesData = null; // ì´ˆê¸° nullë¡œ ì„¤ì •, ë¡œë“œ í›„ ê°ì²´ í• ë‹¹
        let userBookmarks = [];
        let visits = {};
        const API_BASE = '';

        document.addEventListener('DOMContentLoaded', initializeApp);

        async function initializeApp() {
            console.log("[Client] initializeApp started.");
            showLoading();
            try {
                await loadTranslations(currentLanguage);
                console.log("[Client] Translations loaded.");

                // ëª¨ë“  ì¥ì†Œ ë°ì´í„° ë¡œë“œë¥¼ ë¨¼ì € ì™„ë£Œì‹œí‚´
                await loadAllPlacesFromServer();
                console.log("[Client] All places data loaded:", allPlacesData ? 'Data received' : 'No data/Error');
                if (!allPlacesData || Object.keys(allPlacesData).length === 0) {
                    console.error("[Client] Critical error: allPlacesData is not loaded or empty. Aborting further data loading.");
                    alert(getNestedProperty(translations, 'error.appInit') || 'ê´€ê´‘ì§€ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.');
                    hideLoading();
                    return;
                }

                const bookmarksPromise = loadUserBookmarks();
                const visitsPromise = loadVisits();
                await Promise.all([bookmarksPromise, visitsPromise]);
                console.log("[Client] Bookmarks and visits loaded.");
                
                await loadPopularPlaces();
                console.log("[Client] Popular places displayed.");
                await loadBookmarkedPlacesDisplay();
                console.log("[Client] Bookmarked places displayed.");
                await loadStats();
                console.log("[Client] Stats updated.");
                
                setupEventListeners();
                console.log("[Client] Event listeners set up.");
            } catch (error) {
                console.error('[Client] initializeApp error:', error);
                alert(getNestedProperty(translations, 'error.appInit') || 'ì•± ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            } finally {
                hideLoading();
                console.log("[Client] initializeApp finished.");
            }
        }

        function setupEventListeners() {
            document.getElementById('mobileMenuBtn').addEventListener('click', () => document.getElementById('mainNav').classList.toggle('active'));
            document.getElementById('searchInput').addEventListener('keypress', e => { if (e.key === 'Enter') searchPlaces(true); });
            document.querySelectorAll('a[href^="#"]').forEach(anchor => anchor.addEventListener('click', smoothScrollToAnchor));
            document.getElementById('searchBtn').addEventListener('click', () => searchPlaces(true));
        }
        
        function smoothScrollToAnchor(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                const header = document.querySelector('header');
                const headerOffset = header ? header.offsetHeight : 70;
                const elementPosition = targetElement.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                window.scrollTo({ top: offsetPosition, behavior: "smooth" });
                const nav = document.getElementById('mainNav');
                if (nav.classList.contains('active')) nav.classList.remove('active');
            }
        }

        function showLoading() { document.getElementById('loadingScreen').style.display = 'flex'; }
        function hideLoading() { document.getElementById('loadingScreen').style.display = 'none'; }

        async function loadTranslations(lang) {
            try {
                const response = await fetch(`${API_BASE}/api/translations/${lang}`);
                if (!response.ok) throw new Error(`HTTP ${response.status} for translations`);
                translations = await response.json();
                updateUIWithTranslations();
            } catch (error) {
                console.error(`[Client] loadTranslations error (${lang}):`, error);
                if (lang !== 'ko' && translations['ko']) {
                     updateUIWithTranslations(); 
                } else if (lang !== 'ko') { 
                    await loadTranslations('ko'); 
                }
            }
        }

        async function changeLanguage() {
            currentLanguage = document.getElementById('languageSelect').value;
            console.log(`[Client] Changing language to: ${currentLanguage}`);
            showLoading();
            await loadTranslations(currentLanguage);
            await loadPopularPlaces(); 
            await loadBookmarkedPlacesDisplay(); 
            const searchResultsSection = document.getElementById('searchResultsDisplay');
            if (searchResultsSection.style.display !== 'none') {
                await searchPlaces(false); 
            }
            await loadStats(); 
            hideLoading();
        }

        function updateUIWithTranslations() {
            document.documentElement.lang = currentLanguage;
            document.querySelectorAll('[data-text]').forEach(el => {
                const key = el.getAttribute('data-text');
                const text = getNestedProperty(translations, key);
                if (text !== null) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') el.placeholder = text;
                    else el.innerHTML = text;
                }
            });
            document.querySelectorAll('[data-placeholder]').forEach(el => {
                const key = el.getAttribute('data-placeholder');
                const text = getNestedProperty(translations, key);
                if (text !== null) el.placeholder = text;
            });
        }

        function getNestedProperty(obj, path) {
            if (!obj || !path) return null;
            return path.split('.').reduce((o, p) => (o && o[p] !== undefined) ? o[p] : null, obj);
        }
        
        async function loadAllPlacesFromServer() {
            console.log("[Client] loadAllPlacesFromServer called.");
            try {
                const response = await fetch(`${API_BASE}/api/places`);
                if (!response.ok) throw new Error('Failed to load places from server, status: ' + response.status);
                allPlacesData = await response.json();
                if (typeof allPlacesData !== 'object' || allPlacesData === null || Object.keys(allPlacesData).length === 0) { 
                    console.error("[Client] Invalid or empty places data received:", allPlacesData);
                    allPlacesData = { southwesternregion: [], northeasternregion: [], JungguDistrict: [] }; // ê¸°ë³¸ê°’ ì„¤ì •
                }
                console.log("[Client] loadAllPlacesFromServer success. Data keys:", Object.keys(allPlacesData));
            } catch (error) {
                console.error('[Client] loadAllPlacesFromServer error:', error);
                allPlacesData = { southwesternregion: [], northeasternregion: [], JungguDistrict: [] };
            }
        }
        
        function getAllPlacesArray() { 
            if (!allPlacesData || typeof allPlacesData !== 'object') {
                console.warn("[Client] getAllPlacesArray: allPlacesData is not valid. Returning empty array.");
                return [];
            }
            return Object.values(allPlacesData).flat().filter(p => p && p.id); 
        }

        async function loadUserBookmarks() {
            try {
                const response = await fetch(`${API_BASE}/api/bookmarks`);
                if (!response.ok) throw new Error('Failed to load bookmarks');
                userBookmarks = await response.json();
                if (!Array.isArray(userBookmarks)) userBookmarks = [];
            } catch (error) {
                console.error('[Client] loadUserBookmarks error:', error);
                userBookmarks = [];
            }
        }
        
        async function loadVisits() {
            try {
                const response = await fetch(`${API_BASE}/api/visits`);
                if (response.ok) {
                     visits = await response.json();
                     if (typeof visits !== 'object' || visits === null) visits = {};
                } else { visits = {}; }
            } catch (error) { 
                console.error('[Client] loadVisits error:', error);
                visits = {};
            }
        }
        
        function searchPlacesByRegion(regionKey) {
            console.log(`[Client] searchPlacesByRegion called with regionKey: ${regionKey}`);
            document.getElementById('regionFilter').value = regionKey;
            document.getElementById('searchInput').value = ''; 
            searchPlaces(true); 
        }

        async function searchPlaces(scrollToResults = true) {
            const keyword = document.getElementById('searchInput').value;
            const region = document.getElementById('regionFilter').value;
            console.log(`[Client] searchPlaces called. Keyword: "${keyword}", Region: "${region}", Scroll: ${scrollToResults}`);
            showLoading();
            try {
                const params = new URLSearchParams({ lang: currentLanguage });
                if (keyword) params.append('keyword', keyword);
                if (region && region !== 'all') params.append('region', region);
                
                console.log(`[Client] Fetching search results with params: ${params.toString()}`);
                const response = await fetch(`${API_BASE}/api/search?${params.toString()}`);
                if (!response.ok) throw new Error(`Search request failed: ${response.status} ${response.statusText}`);
                const places = await response.json();
                console.log(`[Client] Search results received (count: ${places.length}):`, places);
                
                const resultsGrid = document.getElementById('resultsGrid');
                const resultsSection = document.getElementById('searchResultsDisplay');
                
                displayPlaces(places, resultsGrid); 
                updateResultsTitle(places.length, keyword, region);
                resultsSection.style.display = 'block'; 

                if (scrollToResults && places && places.length > 0) { 
                    const header = document.querySelector('header');
                    const headerOffset = header ? header.offsetHeight : 70;
                    const elementPosition = resultsSection.getBoundingClientRect().top;
                    const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                    window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
                }
            } catch (error) {
                console.error('[Client] searchPlaces error:', error);
                document.getElementById('resultsGrid').innerHTML = `<p>${getNestedProperty(translations, 'error.search') || 'ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'}</p>`;
                document.getElementById('searchResultsDisplay').style.display = 'block'; 
            } finally {
                hideLoading();
            }
        }

        function displayPlaces(places, gridElement) {
            console.log(`[Client] displayPlaces called for grid:`, gridElement, `with ${places ? places.length : 0} places.`);
            gridElement.innerHTML = ''; 
            if (!places || places.length === 0) {
                gridElement.innerHTML = `<p style="text-align: center; grid-column: 1/-1; padding: 40px;">${getNestedProperty(translations, 'status.noResults') || 'í‘œì‹œí•  ê´€ê´‘ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.'}</p>`;
                return;
            }
            places.forEach(place => {
                if (place && place.id) { 
                    gridElement.appendChild(createPlaceCard(place));
                } else {
                    console.warn("[Client] Invalid place data in displayPlaces:", place);
                }
            });
        }

        function createPlaceCard(place) {
            const card = document.createElement('div');
            card.className = 'place-card';
            
            const visitCount = visits[place.id] || 0;
            const name = (place.name && (place.name[currentLanguage] || place.name.ko)) || 'ì´ë¦„ ì—†ìŒ';
            const description = (place.description && (place.description[currentLanguage] || place.description.ko)) || 'ì„¤ëª… ì—†ìŒ';
            const mapButtonText = getNestedProperty(translations, 'placeCard.mapButton') || 'ì§€ë„ ë³´ê¸°';
            const isBookmarked = userBookmarks.includes(place.id);
            const bookmarkTitle = isBookmarked ? (getNestedProperty(translations, 'placeCard.removeBookmark') || 'ì¦ê²¨ì°¾ê¸° ì œê±°') : (getNestedProperty(translations, 'placeCard.addBookmark') || 'ì¦ê²¨ì°¾ê¸° ì¶”ê°€');

            card.innerHTML = `
                <div class="place-img" onclick="visitPlace('${place.id}', this.closest('.place-card'))">
                    <img src="${place.image || 'https://via.placeholder.com/300x200?text=No+Image'}" alt="${name}" onerror="this.src='https://via.placeholder.com/300x200?text=Image+Error'">
                    <div class="visit-count"><i class="fas fa-eye"></i> ${visitCount}</div>
                    <i class="fas fa-star bookmark-icon ${isBookmarked ? 'active' : ''}" title="${bookmarkTitle}" onclick="event.stopPropagation(); toggleBookmark('${place.id}', this);"></i>
                </div>
                <div class="place-content">
                    <h3>${name}</h3>
                    <p>${description}</p>
                </div>
                <div class="place-footer">
                    <a href="${place.mapLink || '#'}" target="_blank" class="map-btn" onclick="event.stopPropagation()"><i class="fas fa-map-marker-alt"></i> ${mapButtonText}</a>
                </div>
            `;
            return card;
        }
        
        async function toggleBookmark(placeId, iconElement) {
            if (!placeId || !iconElement) return;
            const isActive = iconElement.classList.contains('active');
            const method = isActive ? 'DELETE' : 'POST';
            const url = isActive ? `${API_BASE}/api/bookmark/${placeId}` : `${API_BASE}/api/bookmark`;
            
            try {
                const response = await fetch(url, {
                    method: method,
                    headers: method === 'POST' ? { 'Content-Type': 'application/json' } : {},
                    body: method === 'POST' ? JSON.stringify({ placeId }) : null,
                });
                if (!response.ok) throw new Error(`Bookmark operation failed: ${response.statusText}`);
                if (isActive) {
                    userBookmarks = userBookmarks.filter(id => id !== placeId);
                    iconElement.classList.remove('active');
                    iconElement.title = getNestedProperty(translations, 'placeCard.addBookmark') || 'ì¦ê²¨ì°¾ê¸° ì¶”ê°€';
                } else {
                    userBookmarks.push(placeId);
                    iconElement.classList.add('active');
                    iconElement.title = getNestedProperty(translations, 'placeCard.removeBookmark') || 'ì¦ê²¨ì°¾ê¸° ì œê±°';
                }
                await loadBookmarkedPlacesDisplay(); 
            } catch (error) {
                console.error('[Client] toggleBookmark error:', error);
                alert(getNestedProperty(translations, 'error.bookmarkToggle') || 'ì¦ê²¨ì°¾ê¸° ì‘ì—… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        async function visitPlace(placeId, cardElement) {
            if (!placeId) return;
            try {
                const response = await fetch(`${API_BASE}/api/places/${placeId}/visit`, { method: 'POST' });
                if (response.ok) {
                    const result = await response.json();
                    visits[placeId] = result.visitCount;
                    if (cardElement) {
                        const visitCountEl = cardElement.querySelector('.visit-count');
                        if (visitCountEl) visitCountEl.innerHTML = `<i class="fas fa-eye"></i> ${result.visitCount}`;
                    }
                    await loadStats(); 
                    await loadPopularPlaces();
                }
            } catch (error) { console.error('[Client] visitPlace error:', error); }
        }

        function updateResultsTitle(count, keyword, region) {
            const titleEl = document.getElementById('resultsTitle');
            const countEl = document.getElementById('resultsCount');
            let titleTextKey = (!keyword && (!region || region === 'all')) ? 'searchResults.allPlacesTitle' : 'searchResults.title';
            titleEl.textContent = getNestedProperty(translations, titleTextKey) || 'ê´€ê´‘ì§€';
            countEl.textContent = `${getNestedProperty(translations, 'searchResults.countPrefix') || 'ì´'} ${count} ${getNestedProperty(translations, 'searchResults.countSuffix') || 'ê°œì˜ ê´€ê´‘ì§€ê°€ ìˆìŠµë‹ˆë‹¤'}`;
        }
        
        async function loadPopularPlaces() {
            console.log("[Client] loadPopularPlaces called.");
            const popularGrid = document.getElementById('popularGrid');
            popularGrid.innerHTML = ''; 
            try {
                const statsResponse = await fetch(`${API_BASE}/api/stats`);
                if (!statsResponse.ok) throw new Error('Failed to load stats for popular places, status: ' + statsResponse.status);
                const stats = await statsResponse.json();
                console.log("[Client] Stats for popular places:", stats);

                if (stats.popularPlaces && stats.popularPlaces.length > 0) {
                    const allCurrentPlaces = getAllPlacesArray(); 
                    if (allCurrentPlaces.length === 0 && allPlacesData === null) { // allPlacesDataê°€ ì•„ì§ ë¡œë“œ ì‹œë„ ì „ì´ë©´
                        console.warn("[Client] loadPopularPlaces: allPlacesData is null, waiting for it to load.");
                        popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'error.loadPopular') || 'ì¸ê¸° ê´€ê´‘ì§€ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...'}</p>`;
                        return; 
                    }
                     if (allCurrentPlaces.length === 0 && allPlacesData !== null) { // ë¡œë“œ ì‹œë„í–ˆìœ¼ë‚˜ ë¹„ì–´ìˆë‹¤ë©´
                        console.warn("[Client] loadPopularPlaces: allPlacesData is loaded but empty. Cannot show popular places details.");
                        popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noPopularPlacesDetail') || 'ì¸ê¸° ê´€ê´‘ì§€ ìƒì„¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤ (ë°ì´í„° ë¶€ì¡±).'}</p>`;
                        return;
                    }
                    
                    const popularToDisplay = stats.popularPlaces.slice(0, 3); 
                    let displayedCount = 0;
                    for (const popular of popularToDisplay) {
                        const placeDetail = allCurrentPlaces.find(p => p.id === popular.id);
                        if (placeDetail) {
                            popularGrid.appendChild(createPlaceCard(placeDetail));
                            displayedCount++;
                        } else {
                            console.warn(`[Client] Popular place ID ${popular.id} not found in allCurrentPlaces.`);
                        }
                    }
                    if (displayedCount === 0 && popularToDisplay.length > 0) {
                         popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noPopularPlacesDetail') || 'ì¸ê¸° ê´€ê´‘ì§€ ìƒì„¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'}</p>`;
                    } else if (popularToDisplay.length === 0) {
                         popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noPopularPlaces') || 'ì¸ê¸° ê´€ê´‘ì§€ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.'}</p>`;
                    }

                } else {
                    popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noPopularPlaces') || 'ì¸ê¸° ê´€ê´‘ì§€ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.'}</p>`;
                }
            } catch (error) {
                console.error('[Client] loadPopularPlaces error:', error);
                popularGrid.innerHTML = `<p>${getNestedProperty(translations, 'error.loadPopular') || 'ì¸ê¸° ê´€ê´‘ì§€ ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒ.'}</p>`;
            }
        }

        async function loadBookmarkedPlacesDisplay() {
            console.log("[Client] loadBookmarkedPlacesDisplay called.");
            const bookmarksGrid = document.getElementById('bookmarksGrid');
            bookmarksGrid.innerHTML = '';
            if (userBookmarks.length === 0) {
                bookmarksGrid.innerHTML = `<p style="text-align:center;">${getNestedProperty(translations, 'status.noBookmarks') || 'ì¦ê²¨ì°¾ê¸°í•œ ê´€ê´‘ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.'}</p>`;
                return;
            }
            const allCurrentPlaces = getAllPlacesArray();
            if (allCurrentPlaces.length === 0 && allPlacesData === null) {
                console.warn("[Client] loadBookmarkedPlacesDisplay: allPlacesData is null, waiting.");
                bookmarksGrid.innerHTML = `<p>${getNestedProperty(translations, 'error.loadBookmarks') || 'ì¦ê²¨ì°¾ê¸° ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...'}</p>`;
                return;
            }
            if (allCurrentPlaces.length === 0 && allPlacesData !== null) {
                 console.warn("[Client] loadBookmarkedPlacesDisplay: allPlacesData is empty.");
                bookmarksGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noBookmarksDetail') || 'ì¦ê²¨ì°¾ê¸°í•œ ê´€ê´‘ì§€ ìƒì„¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤ (ë°ì´í„° ë¶€ì¡±).'}</p>`;
                return;
            }

            let displayedCount = 0;
            userBookmarks.forEach(bookmarkId => {
                const placeDetail = allCurrentPlaces.find(p => p.id === bookmarkId);
                if (placeDetail) {
                    bookmarksGrid.appendChild(createPlaceCard(placeDetail));
                    displayedCount++;
                } else {
                    console.warn(`[Client] Bookmarked place ID ${bookmarkId} not found in allCurrentPlaces.`);
                }
            });
             if (displayedCount === 0 && userBookmarks.length > 0) {
                 bookmarksGrid.innerHTML = `<p>${getNestedProperty(translations, 'status.noBookmarksDetail') || 'ì¦ê²¨ì°¾ê¸°í•œ ê´€ê´‘ì§€ ìƒì„¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'}</p>`;
            }
        }

        async function getRecommendation() {
            const theme = document.getElementById('themeSelect').value;
            const duration = document.getElementById('durationSelect').value;
            showLoading();
            try {
                const params = new URLSearchParams({ theme, duration, lang: currentLanguage });
                const response = await fetch(`${API_BASE}/api/recommend?${params.toString()}`);
                if (!response.ok) throw new Error('Recommendation request failed');
                const recommendation = await response.json();
                displayRecommendation(recommendation);
            } catch (error) {
                console.error('[Client] getRecommendation error:', error);
                const resultBox = document.getElementById('aiCourseBox');
                resultBox.innerHTML = `<p>${getNestedProperty(translations, 'error.recommend') || 'ì¶”ì²œ ì½”ìŠ¤ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ.'}</p>`;
                resultBox.style.display = 'block';
            } finally {
                hideLoading();
            }
        }

        function displayRecommendation(recommendation) {
            const resultBox = document.getElementById('aiCourseBox');
            const places = recommendation.recommendedPlaces;
            if (!places || places.length === 0) {
                resultBox.innerHTML = `<p style="text-align: center;">${getNestedProperty(translations, 'status.noRecommendation') || 'ì¶”ì²œí•  ìˆ˜ ìˆëŠ” ê´€ê´‘ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.'}</p>`;
                resultBox.style.display = 'block'; return;
            }
            const themeEmoji = { nature: "ğŸŒ¿", history: "ğŸ›ï¸", culture: "ğŸ­", shopping: "ğŸ›ï¸" };
            const durationText = recommendation.duration === "half" ? (getNestedProperty(translations, 'recommend.durations.half') || "ë°˜ë‚˜ì ˆ") : (getNestedProperty(translations, 'recommend.durations.full') || "í•˜ë£¨ ì¢…ì¼");
            const themeText = getNestedProperty(translations, `recommend.themes.${recommendation.theme}`) || recommendation.theme;
            let courseHTML = `<h3>${themeEmoji[recommendation.theme] || 'âœ¨'} ${durationText} ${themeText} ${getNestedProperty(translations, 'recommend.courseTitleSuffix') || 'í…Œë§ˆ ì¶”ì²œ ì½”ìŠ¤'}</h3><div>`;
            places.forEach((place, index) => {
                const name = (place.name && (place.name[currentLanguage] || place.name.ko)) || 'ì´ë¦„ ì—†ìŒ';
                const description = ((place.description && (place.description[currentLanguage] || place.description.ko)) || 'ì„¤ëª… ì—†ìŒ').substring(0, 80) + '...';
                const imageSrc = place.image || 'https://via.placeholder.com/60x60?text=No+Image';
                courseHTML += `<div class="course-item" onclick="visitPlace('${place.id}', this)">
                                <img src="${imageSrc}" alt="${name}" onerror="this.src='https://via.placeholder.com/60x60?text=Error'">
                                <div class="course-info"><h4>${index + 1}. ${name}</h4><p>${description}</p></div></div>`;
            });
            const placeNamesForMap = places.map(p => (p.name && (p.name[currentLanguage] || p.name.ko)) || '');
            const gmapQuery = `https://www.google.com/maps/search/?api=1&query=${placeNamesForMap.filter(name => name).map(encodeURIComponent).join(' AND ')}`;
            courseHTML += `</div><a href="${gmapQuery}" target="_blank" class="map-link"><i class="fas fa-route"></i> ${getNestedProperty(translations, 'recommend.viewMapButton') || 'ì§€ë„ì—ì„œ ì „ì²´ ì½”ìŠ¤ ë³´ê¸°'}</a>`;
            resultBox.innerHTML = courseHTML; resultBox.style.display = 'block';
        }

        async function loadStats() {
            try {
                const response = await fetch(`${API_BASE}/api/stats`);
                if (!response.ok) throw new Error('Failed to load stats');
                const stats = await response.json();
                updateStatsDisplay(stats);
            } catch (error) { console.error('[Client] loadStats error:', error); }
        }

        function updateStatsDisplay(stats) {
            document.getElementById('totalPlaces').textContent = stats.totalPlaces || 0;
            document.getElementById('totalVisits').textContent = stats.totalVisits || 0;
            const mostPopularEl = document.getElementById('mostPopularPlaceName');
            if (stats.popularPlaces && stats.popularPlaces.length > 0) {
                const popularPlaceId = stats.popularPlaces[0].id;
                const allCurrentPlaces = getAllPlacesArray();
                const popularPlaceDetail = allCurrentPlaces.find(p => p.id === popularPlaceId);
                if (popularPlaceDetail) mostPopularEl.textContent = (popularPlaceDetail.name && (popularPlaceDetail.name[currentLanguage] || popularPlaceDetail.name.ko)) || '-';
                else mostPopularEl.textContent = '-';
            } else { mostPopularEl.textContent = '-'; }
            document.getElementById('activeUsers').textContent = Math.floor(Math.random() * 50) + 10; 
        }
    </script>
</body>
</html>